---
- name: unifi controller
  containers.podman.podman_container:
    name: unifi
    # https://hub.docker.com/r/linuxserver/unifi-controller
    image: lscr.io/linuxserver/unifi-controller
    state: "{{ container_state }}"
    recreate: "{{ container_recreate }}"
    generate_systemd: "{{ container_generate_systemd }}"
    env:
      PUID: "0"
      PGID: "0"
      TZ: "{{ tz }}"
    volumes:
      - "{{ appdata_dir }}/unifi:/config"
    ports:
      - 3018:8443 # web admin
      - 8080:8080 # device communication
      - 3478:3478/udp # STUN
      - 10001:10001/udp # AP discovery
      - 1900:1900/udp # 'Make controller discoverable on L2 network' option
      - 8843:8843 # guest portal HTTPS redirect port
      - 8880:8880 # guest portal HTTP redirect port
      - 6789:6789 # mobile throughput test
      - 5514:5514/udp # Remote syslog port
    label:
      io.containers.autoupdate: registry
